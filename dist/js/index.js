!function(s,a){function t(t){this.wrap=t,this.dataList=[],this.indexObj=null,this.imgRotateTimer=null,this.list=null,this.curIndex=0}t.prototype={init:function(){this.getDom(),this.getData("../mock/data.json")},getDom:function(){this.record=document.querySelector(".songImg img"),this.controlBtns=document.querySelectorAll(".control li")},getData:function(t){var i=this;s.ajax({url:t,method:"get",success:function(t){i.dataList=t,i.listPlay(),i.indexObj=new a.controlIndex(t.length),i.loadMusic(i.indexObj.index),i.musicControl(i.indexObj.index),i.bindTouch()},error:function(){}})},loadMusic:function(t){a.render(this.dataList[t]),a.pro.renderSongTime(this.dataList[t].duration),a.music.load(this.dataList[t].audio),"play"==a.music.status&&(a.music.play(),this.controlBtns[2].className="playing",this.imgRotate(0)),this.list.changeSelect(t),this.curIndex=t},musicControl:function(){var i=this;this.controlBtns[1].addEventListener("touchend",function(){a.music.status="play",i.loadMusic(i.indexObj.prev()),a.pro.stop(),a.pro.start(0)}),this.controlBtns[2].addEventListener("touchend",function(){var t;"play"==a.music.status?(a.music.pause(),this.className="",clearInterval(i.imgRotateTimer),a.pro.stop()):(a.music.play(),this.className="playing",a.pro.start(),t=i.record.dataset.rotate||0,i.imgRotate(t))}),this.controlBtns[3].addEventListener("touchend",function(){a.music.status="play",i.loadMusic(i.indexObj.next()),a.pro.stop(),a.pro.start(0)})},imgRotate:function(t){var i=this;clearInterval(this.imgRotateTimer),this.imgRotateTimer=setInterval(function(){t=(+t+.2)%360,i.record.style.transform="rotate("+t+"deg)",i.record.dataset.rotate=t},1e3/60)},listPlay:function(){var s=this;this.list=a.listControl(this.dataList,this.wrap),this.controlBtns[4].addEventListener("touchend",function(){s.list.sildeUp()}),this.list.musicList.forEach(function(t,i){t.addEventListener("touchend",function(){i!==s.curIndex&&(s.indexObj.index=i,s.loadMusic(i),"play"==a.music.status?a.pro.start(0):"pause"==a.music.status&&(a.pro.start(0),a.pro.stop()))})})},bindTouch:function(){var n=this,t=document.getElementsByClassName("circle")[0],i=document.getElementsByClassName("drag")[0],e=i.offsetWidth,o=i.offsetLeft;t.addEventListener("touchstart",function(){a.pro.stop()}),t.addEventListener("touchmove",function(t){var i=(t.changedTouches[0].clientX-o)/e;a.pro.upData(i)}),t.addEventListener("touchend",function(t){var i=1<(i=(t.changedTouches[0].clientX-o)/e)?1:i<0?0:i,s=Math.floor(n.dataList[n.curIndex].duration*i);a.music.playTo(s),a.pro.start(i),"pause"==a.music.status&&(a.music.play(),n.controlBtns[2].className="playing")})}},new t(document.getElementById("wrap")).init()}(window.Zepto,window.player);